"use strict";(self.webpackChunkpos=self.webpackChunkpos||[]).push([[317],{8317:(v,p,s)=>{s.r(p),s.d(p,{MyProfileModule:()=>X});var c=s(9132),h=s(4466),u=s(9170),e=s(4650),f=s(3848),r=s(4006),g=s(364),_=s(2340),w=s(529),C=s(4707);let P=(()=>{class t{constructor(o){this.http=o,this.url=_.N.API_BASE_URL,this.httpOptions={headers:(new w.WM).set("Content-Type","application/json")},this._user=new C.t,this._refresh=new C.t}getProfile(){return this.http.get(this.url+"/my-profiles",this.httpOptions)}updateProfile(o){return this.http.post(this.url+"/my-profiles",o,this.httpOptions)}updatePassword(o){return this.http.post(this.url+"/my-profiles/change-password",o,this.httpOptions)}set user(o){this._user.next(o)}get user$(){return this._user.asObservable()}set token(o){this._refresh.next(o)}get token$(){return this._refresh.asObservable()}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(w.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var y=s(1059),b=s(3056),Z=s(6895),I=s(4859),d=s(9549),x=s(4144),T=s(1572),N=s(2614);const O=["myProfileNgForm"];function M(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Full name is required "),e.qZA())}function J(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Phone number is required "),e.qZA())}function U(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid phone number "),e.qZA())}function F(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Email address is required "),e.qZA())}function A(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid email address "),e.qZA())}function Q(t,n){1&t&&(e.TgZ(0,"span",16),e._uU(1," Confirm "),e.qZA())}function k(t,n){1&t&&e._UZ(0,"mat-progress-spinner",17),2&t&&e.Q6J("diameter",24)("mode","indeterminate")}let S=(()=>{class t{constructor(o,a,i,l,m){this._serviceMyProfile=o,this._formBuilder=a,this._snackBar=i,this._router=l,this._loadingService=m,this.url=_.N.API_BASE_URL,this.FILE_PUBLIC_BASE_URL=_.N.FILE_PUBLIC_BASE_URL,this.contact=[],this.saving=!1,this.src="assets/images/avatars/profile.jpg",this.title="Pick your profile picture",this.user={id:null,name:null,email:null,avatar:null,phone:null}}ngOnInit(){this.data=localStorage.getItem("user"),this.data&&(this.data=JSON.parse(this.data),this.data||(localStorage.clear(),this._router.navigateByUrl("/auth/login"))),this.data&&(this.src=this.FILE_PUBLIC_BASE_URL+this.data.avatar),this._buildForm()}submit(){this.form.invalid||(this.form.disable(),this.saving=!0,this._serviceMyProfile.updateProfile(this.form.value).subscribe(o=>{this.saving=!1,console.log(o.data),this.form.enable(),o.data&&(console.log(o.data),this.user.id=o.data.id,this.user.email=o.data.email,this.user.name=o.data.name,this.user.avatar=o.data.avatar,""==o.data.avatar?this.user.avatar="assets/images/avatars/default.jpg":this.data.avatar=this.FILE_PUBLIC_BASE_URL+o.data.avatar,this.user.phone=o.data.phone,localStorage.setItem("user",JSON.stringify(this.user))),this._snackBar.openSnackBar(o.message,"")},()=>{this.form.enable(),this.myProfileNgForm.resetForm(),this.saving=!1}))}srcChange(o){this.form.get("avatar").setValue(o)}_buildForm(){this.form=this._formBuilder.group({name:[this.data.name,[r.kI.required]],phone:[this.data.phone,[r.kI.required,r.kI.pattern("(^[0][0-9].{7}$)|(^[0][0-9].{8}$)|(^[855][0-9].{9}$)|(^[855][0-9].{10}$)|(.+@.+..+)")]],email:[this.data.email,[r.kI.email,r.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$")]],avatar:[this.data.avatar]})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(P),e.Y36(r.QS),e.Y36(y.o),e.Y36(c.F0),e.Y36(b.b))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-overview"]],viewQuery:function(o,a){if(1&o&&e.Gf(O,5),2&o){let i;e.iGM(i=e.CRH())&&(a.myProfileNgForm=i.first)}},decls:28,vars:14,consts:[[1,"main-content-overview","p-3"],[1,"overview-image"],["mode","mode",3,"src","title","srcChange"],[1,"w-full","p-6"],[1,"w-full"],[1,"custom-form",3,"formGroup"],["myProfileNgForm","ngForm"],["appearance","outline",1,"w-full","mb-5"],["id","name","matInput","",3,"formControlName"],[4,"ngIf"],["id","phone","matInput","",1,"siereap",3,"formControlName"],["id","email","matInput","",1,"siereap",3,"formControlName"],[1,"flex","justify-end"],["mat-flat-button","",1,"w-full","py-6","sm:min-w-20","sm:max-w-20","min-h-11","max-h-11","rounded-md","custom-button",3,"disabled","click"],["class","text-lg",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"text-lg"],[3,"diameter","mode"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"app-portrait",2),e.NdJ("srcChange",function(l){return a.srcChange(l)}),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"form",5,6)(7,"mat-form-field",7)(8,"mat-label"),e._uU(9,"Name"),e.qZA(),e._UZ(10,"input",8),e.YNc(11,M,2,0,"mat-error",9),e.qZA(),e.TgZ(12,"mat-form-field",7)(13,"mat-label"),e._uU(14,"Phone Number"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,J,2,0,"mat-error",9),e.YNc(17,U,2,0,"mat-error",9),e.qZA(),e.TgZ(18,"mat-form-field",7)(19,"mat-label"),e._uU(20,"Email"),e.qZA(),e._UZ(21,"input",11),e.YNc(22,F,2,0,"mat-error",9),e.YNc(23,A,2,0,"mat-error",9),e.qZA(),e.TgZ(24,"div",12)(25,"button",13),e.NdJ("click",function(){return a.submit()}),e.YNc(26,Q,2,0,"span",14),e.YNc(27,k,1,2,"mat-progress-spinner",15),e.qZA()()()()()()),2&o&&(e.xp6(2),e.Q6J("src",a.src)("title","Choose an image"),e.xp6(3),e.Q6J("formGroup",a.form),e.xp6(5),e.Q6J("formControlName","name"),e.xp6(1),e.Q6J("ngIf",a.form.get("name").hasError("required")),e.xp6(4),e.Q6J("formControlName","phone"),e.xp6(1),e.Q6J("ngIf",a.form.get("phone").hasError("required")),e.xp6(1),e.Q6J("ngIf",a.form.get("phone").hasError("phone")),e.xp6(4),e.Q6J("formControlName","email"),e.xp6(1),e.Q6J("ngIf",a.form.get("email").hasError("required")),e.xp6(1),e.Q6J("ngIf",a.form.get("email").hasError("email")),e.xp6(2),e.Q6J("disabled",a.form.invalid||a.saving),e.xp6(1),e.Q6J("ngIf",!a.form.disabled),e.xp6(1),e.Q6J("ngIf",a.form.disabled))},dependencies:[Z.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,I.lW,d.TO,d.KE,d.hX,x.Nt,T.Ou,N.w],styles:[".main-content-overview[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:300px calc(100% - 315px);gap:15px}.overview-image[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}@media (max-width: 960px){.main-content-overview[_ngcontent-%COMP%]{grid-template-columns:1fr}.overview-image[_ngcontent-%COMP%]   .picture[_ngcontent-%COMP%]{margin:2em auto 0;width:60%}}"],data:{animation:g.F}}),t})();var Y=s(7392);const E=["changePasswordNgForm"];function B(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye-off")}function L(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye")}function q(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye-off")}function R(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye")}function G(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye-off")}function j(t,n){1&t&&e._UZ(0,"mat-icon",18),2&t&&e.Q6J("svgIcon","heroicons_solid:eye")}function z(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Password confirmation is required "),e.qZA())}function K(t,n){1&t&&(e.TgZ(0,"mat-error"),e._uU(1," Passwords must match "),e.qZA())}function $(t,n){1&t&&(e.TgZ(0,"span",19),e._uU(1," Confirm "),e.qZA())}function D(t,n){1&t&&e._UZ(0,"mat-progress-spinner",20),2&t&&e.Q6J("diameter",24)("mode","indeterminate")}let H=(()=>{class t{constructor(o,a,i,l,m){this._serviceMyProfile=o,this._formBuilder=a,this._snackBar=i,this.loadingService=l,this._router=m,this.saving=!1}ngOnInit(){this.changePasswordForm=this._formBuilder.group({old_password:["",[r.kI.required,r.kI.minLength(6),r.kI.maxLength(20)]],new_password:["",[r.kI.required,r.kI.minLength(6),r.kI.maxLength(20)]],confirm_password:["",[r.kI.required,r.kI.minLength(6),r.kI.maxLength(20)]]})}changePassword(){this.changePasswordForm.invalid||(this.changePasswordForm.disable(),this.loadingService.show(),this.saving=!0,console.log(this.changePasswordForm.value),this._serviceMyProfile.updatePassword(this.changePasswordForm.value).subscribe(o=>{this.loadingService.hide(),this.saving=!1,this.changePasswordForm.enable(),this._snackBar.openSnackBar(o.message,""),this.changePasswordNgForm.resetForm(),localStorage.clear(),this._router.navigateByUrl("/auth/login")},o=>{this.loadingService.hide(),this.saving=!1,this.changePasswordForm.enable(),this._snackBar.openSnackBar(o.error.message,"error")}))}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(P),e.Y36(r.QS),e.Y36(y.o),e.Y36(b.b),e.Y36(c.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-change-password"]],viewQuery:function(o,a){if(1&o&&e.Gf(E,5),2&o){let i;e.iGM(i=e.CRH())&&(a.changePasswordNgForm=i.first)}},decls:39,vars:15,consts:[[1,"w-full","p-3"],[1,"mt-3","text-3xl","font-extrabold","tracking-tight","leading-tight"],[1,"mt-5","custom-form",3,"formGroup"],["changePasswordNgForm","ngForm"],["appearance","outline",1,"w-full","mb-5"],["id","old_password","matInput","","type","password",3,"formControlName"],["passwordOldField",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["id","password","matInput","","type","password",3,"formControlName"],["passwordField",""],["id","confirm_password","matInput","","type","password",3,"formControlName"],["passwordConfirmField",""],[4,"ngIf"],[1,"flex","justify-end"],["mat-flat-button","",1,"w-full","py-6","sm:min-w-30","sm:max-w-30","min-h-11","max-h-11","rounded-md","custom-button",3,"disabled","click"],["class","text-lg",4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"icon-size-5",3,"svgIcon"],[1,"text-lg"],[3,"diameter","mode"]],template:function(o,a){if(1&o){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Change Password"),e.qZA(),e.TgZ(3,"form",2,3)(5,"mat-form-field",4)(6,"mat-label"),e._uU(7,"Old Password"),e.qZA(),e._UZ(8,"input",5,6),e.TgZ(10,"button",7),e.NdJ("click",function(){e.CHM(i);const m=e.MAs(9);return e.KtG(m.type="password"===m.type?"text":"password")}),e.YNc(11,B,1,1,"mat-icon",8),e.YNc(12,L,1,1,"mat-icon",8),e.qZA(),e.TgZ(13,"mat-error"),e._uU(14," Password is required "),e.qZA()(),e.TgZ(15,"mat-form-field",4)(16,"mat-label"),e._uU(17,"New Password"),e.qZA(),e._UZ(18,"input",9,10),e.TgZ(20,"button",7),e.NdJ("click",function(){e.CHM(i);const m=e.MAs(19);return e.KtG(m.type="password"===m.type?"text":"password")}),e.YNc(21,q,1,1,"mat-icon",8),e.YNc(22,R,1,1,"mat-icon",8),e.qZA(),e.TgZ(23,"mat-error"),e._uU(24," Password is required "),e.qZA()(),e.TgZ(25,"mat-form-field",4)(26,"mat-label"),e._uU(27,"Confirm New Password"),e.qZA(),e._UZ(28,"input",11,12),e.TgZ(30,"button",7),e.NdJ("click",function(){e.CHM(i);const m=e.MAs(29);return e.KtG(m.type="password"===m.type?"text":"password")}),e.YNc(31,G,1,1,"mat-icon",8),e.YNc(32,j,1,1,"mat-icon",8),e.qZA(),e.YNc(33,z,2,0,"mat-error",13),e.YNc(34,K,2,0,"mat-error",13),e.qZA(),e.TgZ(35,"div",14)(36,"button",15),e.NdJ("click",function(){return a.changePassword()}),e.YNc(37,$,2,0,"span",16),e.YNc(38,D,1,2,"mat-progress-spinner",17),e.qZA()()()()}if(2&o){const i=e.MAs(9),l=e.MAs(19),m=e.MAs(29);e.xp6(3),e.Q6J("formGroup",a.changePasswordForm),e.xp6(5),e.Q6J("formControlName","old_password"),e.xp6(3),e.Q6J("ngIf","password"===i.type),e.xp6(1),e.Q6J("ngIf","text"===i.type),e.xp6(6),e.Q6J("formControlName","new_password"),e.xp6(3),e.Q6J("ngIf","password"===l.type),e.xp6(1),e.Q6J("ngIf","text"===l.type),e.xp6(6),e.Q6J("formControlName","confirm_password"),e.xp6(3),e.Q6J("ngIf","password"===m.type),e.xp6(1),e.Q6J("ngIf","text"===m.type),e.xp6(1),e.Q6J("ngIf",a.changePasswordForm.get("confirm_password").hasError("required")),e.xp6(1),e.Q6J("ngIf",a.changePasswordForm.get("confirm_password").hasError("mustMatch")),e.xp6(2),e.Q6J("disabled",a.changePasswordForm.invalid||a.saving),e.xp6(1),e.Q6J("ngIf",!a.changePasswordForm.disabled),e.xp6(1),e.Q6J("ngIf",a.changePasswordForm.disabled)}},dependencies:[Z.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,I.lW,d.TO,d.KE,d.hX,d.R9,Y.Hw,x.Nt,T.Ou]}),t})();const W=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-my-profile"]],decls:9,vars:0,consts:[[1,"container-my-profiles-section","relative"],[1,"container-my-profiles-header"],[1,"container-my-profiles-body","absolute","inset-0","p-6"],[1,"container-my-profiles-content","border","rounded-lg","bg-white"],["label","Overview"],["label","Change Password"]],template:function(o,a){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.TgZ(2,"div",2)(3,"div",3)(4,"mat-tab-group")(5,"mat-tab",4),e._UZ(6,"app-overview"),e.qZA(),e.TgZ(7,"mat-tab",5),e._UZ(8,"app-change-password"),e.qZA()()()()())},dependencies:[f.SP,f.uX,S,H],styles:[".container-my-profiles-section[_ngcontent-%COMP%]{width:100%;height:calc(100dvh - 3.75rem);overflow:hidden}.container-my-profiles-section[_ngcontent-%COMP%]   .container-my-profiles-header[_ngcontent-%COMP%]{width:100%;background-color:#1470ad;min-height:12rem;max-height:12rem}.container-my-profiles-section[_ngcontent-%COMP%]   .container-my-profiles-body[_ngcontent-%COMP%]{width:100%;height:calc(100dvh - 3.75rem);overflow:hidden}.container-my-profiles-section[_ngcontent-%COMP%]   .container-my-profiles-body[_ngcontent-%COMP%]   .container-my-profiles-content[_ngcontent-%COMP%]{width:100%;max-height:calc(100dvh - 5.75rem);overflow:hidden}  .container-my-profiles-content .mat-tab-group .mat-tab-header .mat-tab-label-container .mat-tab-list .mat-tab-labels .mat-tab-label{width:50%}"]}),t})()}];let X=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.m,u.Y,c.Bz.forChild(W)]}),t})()},1059:(v,p,s)=>{s.d(p,{o:()=>u});var c=s(4650),h=s(7009);let u=(()=>{class e{constructor(r){this.snackbar=r}openSnackBar(r,g){this.snackbar.open(r,"","error"===g?{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:["black-snackbar"]}:{horizontalPosition:"right",verticalPosition:"bottom",duration:3e3,panelClass:["green-snackbar"]})}}return e.\u0275fac=function(r){return new(r||e)(c.LFG(h.ux))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9170:(v,p,s)=>{s.d(p,{Y:()=>c.Y});var c=s(9818)}}]);